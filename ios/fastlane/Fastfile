# iOS Fastfile
default_platform(:ios)

before_all do
  ensure_git_branch(branch: 'main')
end

platform :ios do

  lane :beta do
      increment_build_number(xcodeproj: 'app_demo.xcodeproj')
      # xcode_select # Make sure to use the correct Xcode version
      match(
        type: "appstore",
        app_identifier: "oto-fastlane-circleci-test",
        git_url: "https://github.com/kieyanmamicheOtO/match-repo", # Update with your own Git repo
      )
      gym(
        scheme: 'app_demo',
        workspace: 'app_demo.xcworkspace',
        clean: 'true',
        export_method: "app-store",
        export_options: {
          uploadBitcode: false,
          uploadSymbols: true,
        }
      )
      upload_to_testflight
  end

end